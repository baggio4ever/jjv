<mat-toolbar color="primary" class="header">
  <mat-toolbar-row>
    <span>jjv</span>
    <span class="example-spacer"></span>
    <div *ngIf="fileLoaded; then thenBlock else elseBlock2"></div>
    <ng-template #thenBlock>
      <!-- ファイル開いている時 -->
      <span class="toolbar-fn">{{filename}}</span>

      <button mat-icon-button (click)="clear()" matTooltip="閉じる" matTooltipPosition="above">
        <mat-icon aria-label="close file">clear</mat-icon>
      </button>
      <button mat-icon-button (click)="uploadToCloud()" matTooltip="クラウドに保存" matTooltipPosition="above">
        <mat-icon aria-label="upload">cloud_upload</mat-icon>
      </button>
      <a id="save-to-file" href="#" download="dummy.txt" style="display: none;"></a>
      <button mat-icon-button (click)="saveToFile()" matTooltip="ファイルに保存" matTooltipPosition="above">
        <mat-icon aria-label="save">file_download</mat-icon>
      </button>
      <span class="headerDivider"></span>
    </ng-template>
    <ng-template #elseBlock2>
      <!-- ファイル開いていない時 -->
    </ng-template>

    <!-- 共通 -->
    <input id="input-file-id" type="file" #fileInput (change)="onChanged(fileInput.files[0])" accept=".xml,.jdf" style="display: none;">
    <button mat-icon-button (click)="openFileDialog()" matTooltip="ファイルを開く" matTooltipPosition="above">
      <mat-icon aria-label="Open file">folder_open</mat-icon>
    </button>
    <button mat-icon-button (click)="downloadFromCloud()" matTooltip="クラウドから開く" matTooltipPosition="above">
      <mat-icon aria-label="download">cloud_download</mat-icon>
    </button>
    <span class="headerDivider"></span>
    <button mat-icon-button (click)="openSettings()" matTooltip="設定" matTooltipPosition="above">
      <mat-icon aria-label="Settings ...">settings</mat-icon>
    </button>
    <button mat-icon-button (click)="openAbout()" matTooltip="バージョン情報" matTooltipPosition="above">
      <mat-icon aria-label="About ...">info</mat-icon>
    </button>
  </mat-toolbar-row>
</mat-toolbar>

<div id="content">
  <div *ngIf="fileLoaded; else elseBlock">
    <!-- ファイル開いている時 -->
    <div id="fmenu">
<!--      <div class="light-frame"> -->
        <div id="cy"></div>
        
      <mat-divider></mat-divider>

      <div class="graph-tool">
          <button mat-icon-button (click)="relayout()" matTooltip="再整列" matTooltipPosition="above">
            <mat-icon aria-label="update">refresh</mat-icon>
          </button>
          <button mat-icon-button (click)="saveGraphAsPNG()" matTooltip="pngとして保存" matTooltipPosition="above">
            <mat-icon aria-label="save as png">file_download</mat-icon>
          </button>
          <a id="save-as-png" href="#" style="display: none;"></a>
        </div>
<!--      </div> -->
      <mat-divider></mat-divider>
      <div>
        <ul>
          <li *ngIf="jdf.jobTag !== null" class="like-link" (click)="scrollTo('job_top')">Job</li>
          <li *ngIf="jdf.getProcessTagCount()>0" class="like-link" (click)="scrollTo('process_top')">Processes ({{jdf.getProcessTagCount()}})</li>
          <li *ngIf="jdf.getComponentTagCount()>0" class="like-link" (click)="scrollTo('component_top')">Components ({{jdf.getComponentTagCount()}})</li>
          <li *ngIf="jdf.getDeviceTagCount()>0" class="like-link" (click)="scrollTo('device_top')">Devices ({{jdf.getDeviceTagCount()}})</li>
          <li *ngIf="jdf.getStitchingParamsTagCount()>0" class="like-link" (click)="scrollTo('stitchingParams_top')">StitchingParams ({{jdf.getStitchingParamsTagCount()}})</li>
          <li *ngIf="jdf.getTrimmingParamsTagCount()>0" class="like-link" (click)="scrollTo('trimmingParams_top')">TrimmingParams ({{jdf.getTrimmingParamsTagCount()}})</li>
          <li *ngIf="jdf.getCuttingParamsTagCount()>0" class="like-link" (click)="scrollTo('cuttingParams_top')">CuttingParams ({{jdf.getCuttingParamsTagCount()}})</li>
          <li *ngIf="jdf.getFoldingParamsTagCount()>0" class="like-link" (click)="scrollTo('foldingParams_top')">FoldingParams ({{jdf.getFoldingParamsTagCount()}})</li>
          <li *ngIf="jdf.getSpinePreparationParamsTagCount()>0" class="like-link" (click)="scrollTo('spinePreparationParams_top')">SpinePreparationParams ({{jdf.getSpinePreparationParamsTagCount()}})</li>
          <li *ngIf="jdf.getCoverApplicationParamsTagCount()>0" class="like-link" (click)="scrollTo('coverApplicationParams_top')">CoverApplicationParams ({{jdf.getCoverApplicationParamsTagCount()}})</li>
          <li *ngIf="jdf.getStackingParamsTagCount()>0" class="like-link" (click)="scrollTo('stackingParams_top')">StackingParams ({{jdf.getStackingParamsTagCount()}})</li>
          <li *ngIf="jdf.getUnknownResourceTagCount()>0" class="like-link" (click)="scrollTo('unknownResources_top')">Unknown Resources ({{jdf.getUnknownResourceTagCount()}})</li>
        </ul>
      </div>
    </div>

    <div id="main">
      <div *ngIf="jdf.jobTag !== null">
        <h3 id="job_top">Job</h3>
        <div id="{{jdf.jobTag.guid}}" class="example-card" (click)="cardClicked(jdf.jobTag.guid)">
          <mat-card>
            <mat-card-header>
              <mat-card-title>
                <span class="card-title">{{getCardTitle(jdf.jobTag)}}</span>
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <table rules="rows">
                <tr>
                  <td>ID</td>
                  <td>{{jdf.jobTag.id}}</td>
                </tr>
                <tr>
                  <td>JobID</td>
                  <td>{{jdf.jobTag.jobId}}</td>
                </tr>
                <tr>
                  <td>Type</td>
                  <td>{{jdf.jobTag.type}}</td>
                </tr>
                <tr>
                  <td>DescriptiveName</td>
                  <td>{{jdf.jobTag.descriptiveName}}</td>
                </tr>
              </table>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title></mat-panel-title>
                  <mat-panel-description>JDF全部</mat-panel-description>
                </mat-expansion-panel-header>
                <pre><code class="html" [textContent]="jdf.jobTag.body" appMyHighlight></code></pre>
              </mat-expansion-panel>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    
      <div *ngIf="jdf.processTags.length>0">
        <h3 id="process_top">Processes</h3>
        <div>
          <div *ngFor="let t of jdf.processTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card"  (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>JobPartID</td>
                    <td>{{t.jobPartId}}</td>
                  </tr>
                  <tr>
                    <td>Type</td>
                    <td>{{t.type}}</td>
                  </tr>
                  <tr>
                    <td>DescriptiveName</td>
                    <td>{{t.descriptiveName}}</td>
                  </tr>
                  <tr *ngIf="t.inputComponentLinks.length>0">
                    <td>入力</td>
                    <td>
                        <table rules="rows">
                          <tr>
                            <th></th>
                            <th><span class="my-smaller">Amount</span></th>
                          </tr>
                          <tr *ngFor="let l of t.inputComponentLinks">
                            <td><span class="like-link" (click)="scrollAndSelectTo($event,jdf.getResourceTagById(l.rRef).guid)">{{getCardTitle(l.rResource)}}</span></td>
                            <td><span *ngIf="l.amount>0">{{l.amount|number}}</span></td>
                          </tr>
                        </table>
                    </td>
                  </tr>
                  <tr *ngIf="t.outputComponentLinks.length>0">
                    <td>出力</td>
                    <td>
                        <table rules="rows">
                          <tr>
                            <th></th>
                            <th><span class="my-smaller">Amount</span></th>
                          </tr>
                          <tr *ngFor="let l of t.outputComponentLinks">
                            <td><span class="like-link" (click)="scrollAndSelectTo($event,jdf.getResourceTagById(l.rRef).guid)">{{getCardTitle(l.rResource)}}</span></td>
                            <td><span *ngIf="l.amount>0">{{l.amount|number}}</span></td>
                          </tr>
                        </table>
                    </td>
                  </tr>
                  <tr *ngIf="t.paramsLinks.length>0">
                    <td>加工情報</td>
                    <td>
                      <div *ngFor="let l of t.paramsLinks">
                        <span class="like-link" (click)="scrollAndSelectTo($event,jdf.getResourceTagById(l.rRef).guid)">{{getCardTitle(l.rResource)}}</span>
                      </div>
                    </td>
                  </tr>
                  <tr *ngIf="t.deviceLinks.length>0">
                    <td>デバイス情報</td>
                    <td>
                      <div *ngFor="let l of t.deviceLinks">
                        <span class="like-link" (click)="scrollAndSelectTo($event,jdf.getResourceTagById(l.rRef).guid)">{{getCardTitle(l.rResource)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
    
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.componentTags.length>0">
        <h3 id="component_top">Components</h3>
        <div>
          <div *ngFor="let t of jdf.componentTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>ComponentType</td>
                    <td>{{t.componentType}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>Dimensions</td>
                      <td>
                        <table rules="rows">
                          <tr>
                            <td></td>
                            <th><span class="my-smaller">pt</span></th>
                            <th><span class="my-smaller">mm</span></th>
                          </tr>
                          <tr>
                            <td>幅</td>
                            <td>{{t.getDimensionsWidth()}}</td>
                            <td>{{t.getDimensionsWidth_mm()}}</td>
                          </tr>
                          <tr>
                            <td>長さ</td>
                            <td>{{t.getDimensionsLength()}}</td>
                            <td>{{t.getDimensionsLength_mm()}}</td>
                          </tr>
                          <tr>
                            <td>厚さ</td>
                            <td>{{t.getDimensionsThickness()}}</td>
                            <td>{{t.getDimensionsThickness_mm()}}</td>
                          </tr>
                        </table>
                      </td>
                  </tr>
                  <tr *ngIf="jdf.getPreviousProcesses(t).length>0">
                    <td>前工程 <span class="my-smaller">（生成元）</span></td>
                    <td>
                      <div *ngFor="let l of jdf.getPreviousProcesses(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,l.guid)">{{getCardTitle(l)}}</span>
                      </div>
                    </td>
                  </tr>
                  <tr *ngIf="jdf.getNextProcesses(t).length>0">
                    <td>次工程</td>
                    <td>
                      <div *ngFor="let l of jdf.getNextProcesses(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,l.guid)">{{getCardTitle(l)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.deviceTags.length>0">
        <h3 id="device_top">Devices</h3>
        <div>
          <div *ngFor="let t of jdf.deviceTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>DeviceID</td>
                    <td>{{t.deviceId}}</td>
                  </tr>
                  <tr>
                    <td>FriendlyName</td>
                    <td>{{t.friendlyName}}</td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisDevice(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisDevice(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.stitchingParamsTags.length>0">
        <h3 id="stitchingParams_top">StitchingParams</h3>
        <div>
          <div *ngFor="let t of jdf.stitchingParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>NumberOfStitches</td>
                    <td>{{t.numberOfStitches}}</td>
                  </tr>
                  <tr>
                    <td>StapleShape</td>
                    <td>{{t.stapleShape}}</td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.trimmingParamsTags.length>0">
        <h3 id="trimmingParams_top">TrimmingParams</h3>
        <div>
          <div *ngFor="let t of jdf.trimmingParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>NoOp</td>
                    <td>{{t.noOp}}</td>
                  </tr>
                  <tr>
                    <td>TrimmingType</td>
                    <td>{{t.trimmingType}}</td>
                  </tr>
                  <tr>
                    <td>Width</td>
                    <td>
                        <table rules="rows">
                          <tr>
                            <th><span class="my-smaller">pt</span></th>
                            <th><span class="my-smaller">mm</span></th>
                          </tr>
                          <tr>
                            <td>{{t.width}}</td>
                            <td>{{t.getWidth_mm()}}</td>
                          </tr>
                        </table>
                    </td>
                  </tr>
                  <tr>
                    <td>Height</td>
                    <td>
                        <table rules="rows">
                          <tr>
                            <th><span class="my-smaller">pt</span></th>
                            <th><span class="my-smaller">mm</span></th>
                          </tr>
                          <tr>
                            <td>{{t.height}}</td>
                            <td>{{t.getHeight_mm()}}</td>
                          </tr>
                        </table>
                    </td>
                  </tr>
                  <tr>
                    <td>TrimmingOffset</td>
                    <td>
                        <table rules="rows">
                          <tr>
                            <th><span class="my-smaller">pt</span></th>
                            <th><span class="my-smaller">mm</span></th>
                          </tr>
                          <tr>
                            <td>{{t.trimmingOffset}}</td>
                            <td>{{t.getTrimmingOffset_mm()}}</td>
                          </tr>
                        </table>
                    </td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.foldingParamsTags.length>0">
        <h3 id="foldingParams_top">FoldingParams</h3>
        <div>
          <div *ngFor="let t of jdf.foldingParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>DescriptionType</td>
                    <td>{{t.descriptionType}}</td>
                  </tr>
                  <tr>
                    <td>FoldCatalog</td>
                    <td>{{t.foldCatalog}}</td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel *ngIf="t.folds.length>0">
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>Fold</mat-panel-description>
                  </mat-expansion-panel-header>
    
                  <div class="example-container mat-elevation-z8">
                    <mat-table #table3 [dataSource]="t.folds">
                  
                      <!--- Note that these columns can be defined in any order.
                            The actual rendered columns are set as a property on the row definition" -->
                  
                      <!-- To Column -->
                      <ng-container matColumnDef="to">
                        <mat-header-cell *matHeaderCellDef> To </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.to}} </mat-cell>
                      </ng-container>
                  
                      <!-- From Column -->
                      <ng-container matColumnDef="from">
                        <mat-header-cell *matHeaderCellDef> From </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.from}} </mat-cell>
                      </ng-container>
                  
                      <!-- Travel Column -->
                      <ng-container matColumnDef="travel">
                        <mat-header-cell *matHeaderCellDef> Travel </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.travel}} </mat-cell>
                      </ng-container>
    
                      <!-- Travel[mm] Column -->
                      <ng-container matColumnDef="travel_mm">
                        <mat-header-cell *matHeaderCellDef> Travel [mm] </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.getTravel_mm()}} </mat-cell>
                      </ng-container>
    
                      <mat-header-row *matHeaderRowDef="displayedColumns_fold"></mat-header-row>
                      <mat-row *matRowDef="let row; columns: displayedColumns_fold;"></mat-row>
                    </mat-table>
                  </div>
                </mat-expansion-panel>

                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>

              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.cuttingParamsTags.length>0">
        <h3 id="cuttingParams_top">CuttingParams</h3>
        <div>
          <div *ngFor="let t of jdf.cuttingParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel *ngIf="t.cutBlocks.length>0">
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>CutBlock</mat-panel-description>
                  </mat-expansion-panel-header>

                  <div class="example-container mat-elevation-z8">
                    <mat-table #table2 [dataSource]="t.cutBlocks">
                  
                      <!--- Note that these columns can be defined in any order.
                            The actual rendered columns are set as a property on the row definition" -->
                  
                      <!-- ID Column -->
                      <ng-container matColumnDef="id">
                        <mat-header-cell *matHeaderCellDef> ID </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.id}} </mat-cell>
                      </ng-container>
                  
                      <!-- Class Column -->
                      <!--
                      <ng-container matColumnDef="class">
                        <mat-header-cell *matHeaderCellDef> Class </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.klass}} </mat-cell>
                      </ng-container>
                    -->                  
                      <!-- BlockType Column -->
                      <ng-container matColumnDef="blockType">
                        <mat-header-cell *matHeaderCellDef> BlockType </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.blockType}} </mat-cell>
                      </ng-container>
                  
                      <!-- BlockName Column -->
                      <ng-container matColumnDef="blockName">
                        <mat-header-cell *matHeaderCellDef> BlockName </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.blockName}} </mat-cell>
                      </ng-container>
    
                      <!-- BlockSize Column -->
                      <ng-container matColumnDef="blockSize">
                        <mat-header-cell *matHeaderCellDef>
                          BlockSize<br>
                          幅<br>
                          高さ
                        </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                          {{element.getBlockWidth()}}<br>
                          {{element.getBlockHeight()}}
                        </mat-cell>
                      </ng-container>
    
                      <!-- BlockSize Column [mm] -->
                      <ng-container matColumnDef="blockSize_mm">
                        <mat-header-cell *matHeaderCellDef>
                          BlockSize<br>
                          幅 [mm]<br>
                          高さ [mm]
                        </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                          {{element.getBlockWidth_mm()}}<br>
                          {{element.getBlockHeight_mm()}}
                        </mat-cell>
                      </ng-container>
    
                      <!-- BlockTrf Column -->
                      <ng-container matColumnDef="blockTrf">
                        <mat-header-cell *matHeaderCellDef>
                          BlockTrf<br>
                          変換行列？<br>
                          開始X<br>
                          開始Y
                        </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                          {{element.getBlockZz()}}<br>
                          {{element.getBlockX()}}<br>
                          {{element.getBlockY()}}
                        </mat-cell>
                      </ng-container>
    
                      <!-- BlockTrf Column [mm] -->
                      <ng-container matColumnDef="blockTrf_mm">
                        <mat-header-cell *matHeaderCellDef>
                          BlockTrf<br>
                          変換行列？<br>
                          開始X [mm]<br>
                          開始Y [mm]
                        </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                          {{element.getBlockZz()}}<br>
                          {{element.getBlockX_mm()}}<br>
                          {{element.getBlockY_mm()}}
                        </mat-cell>
                      </ng-container>
    
                      <mat-header-row *matHeaderRowDef="displayedColumns_cut"></mat-header-row>
                      <mat-row *matRowDef="let row; columns: displayedColumns_cut;"></mat-row>
                    </mat-table>
                  </div>
                  </mat-expansion-panel>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.coverApplicationParamsTags.length>0">
        <h3 id="coverApplicationParams_top">CoverApplicationParams</h3>
        <div>
          <div *ngFor="let t of jdf.coverApplicationParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>NoOp</td>
                    <td>{{t.noOp}}</td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.spinePreparationParamsTags.length>0">
        <h3 id="spinePreparationParams_top">SpinePreparationParams</h3>
        <div>
          <div *ngFor="let t of jdf.spinePreparationParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>MillingDepth</td>
                    <td>{{t.millingDepth}}</td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    
      <div *ngIf="jdf.stackingParamsTags.length>0">
        <h3 id="stackingParams_top">StackingParams</h3>
        <div>
          <div *ngFor="let t of jdf.stackingParamsTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">
                  <tr>
                    <td>ID</td>
                    <td>{{t.id}}</td>
                  </tr>
                  <tr>
                    <td>Class</td>
                    <td>{{t.klass}}</td>
                  </tr>
                  <tr>
                    <td>StandardAmount</td>
                    <td>{{t.standardAmount}}</td>
                  </tr>
                  <tr>
                    <td>LayerAmount</td>
                    <td>{{t.layerAmount}}</td>
                  </tr>
                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>

      <div *ngIf="jdf.unknownResourceTags.length>0">
        <h3 id="unknownResources_top">Unknown Resources</h3>
        <div>
          <div *ngFor="let t of jdf.unknownResourceTags" id="{{t.guid}}" [class.selected]="isSelected(t.guid)" class="example-card" (click)="cardClicked(t.guid)">
            <mat-card>
              <mat-card-header>
                <mat-card-title>
                  <span class="card-title">{{getCardTitle(t)}}</span>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <table rules="rows">

                  <tr *ngFor="let p of t.attributes">
                    <td>{{p.name}}</td>
                    <td>{{p.value}}</td>
                  </tr>

                  <tr *ngIf="jdf.getProcessesUsingThisParams(t).length>0">
                    <td>利用工程</td>
                    <td>
                      <div *ngFor="let process of jdf.getProcessesUsingThisParams(t)">
                        <span class="like-link" (click)="scrollAndSelectTo($event,process.guid)">{{getCardTitle(process)}}</span>
                      </div>
                    </td>
                  </tr>
                </table>
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title></mat-panel-title>
                    <mat-panel-description>JDF該当部分</mat-panel-description>
                  </mat-expansion-panel-header>
                  <pre><code class="html" [textContent]="t.body" appMyHighlight></code></pre>
                </mat-expansion-panel>
              </mat-card-content>
            </mat-card>
          </div>
        </div>
      </div>
    </div>
      </div>
  <ng-template #elseBlock>
    <!-- ファイル開いていない時 -->
    <div *ngIf="errorHtml" class="parser-error">
      <h2>DOM Pasrser Error:</h2>
      <div [innerHTML]="errorHtml">
      </div>
    </div>

  <div>
      <div id="drop_zone" (drop)="dropHandler($event)" (dragover)="dragOverHandler($event)" (dblclick)="openFileDialog()">
        <p>JDFファイルをドロップしてちょうだい</p>
      </div>
    </div>

  </ng-template>

  <!--
  <button (click)="test()">message-dialog</button><br>
  -->
  <!--
  <button (click)="sayHello()">hello</button><br>
  -->
  <!-- 共通 --
  <button (click)="sayHello()">jjv-serverとテスト通信</button><br>
  <strong>message:</strong><br>
  {{ret_from_http}}<br>
  <strong>input:</strong><br>
  {{ret_from_http_input|json}}<br>
  
  <br><br>
  <button (click)="saveMessage()">jjv-serverにテスト書き込み</button><br>
  {{ret_from_post}}<br>
  <button (click)="saveMessage3()">jjv-serverからgetFiles</button><br>
  -->
  <!--
  <div *ngFor="let m of parseErrorMessages">
  <pre>{{m}}</pre>
  </div>
-->

<!--
  <div> Pre Error HTML</div>
  <pre>{{errorHtml}}</pre>
  <div>Error HTML2</div>
  <div [innerHTML]="safeErrorHtml">
  </div>
-->
  <button (click)="testDownload()">download</button><br>
</div>
